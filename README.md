# Factory Town Production Line Planner

This project is a tool for the game Factory Town. It is designed to take a desired product and generated a production line specification with number of each facilities, as well as the number of workers in each facility.

## Technology Stack

1. [Google Firebase](https://firebase.google.com/)
    - [Firebase Functions](https://firebase.google.com/docs/functions)
    - [Firebase Firestore](https://firebase.google.com/docs/firestore)
1. [GraphQL](https://graphql.org/)
1. [Apollo GraphQL](https://www.apollographql.com/)
    - [Apollo GraphQL Server](https://www.apollographql.com/docs/apollo-server/)
    - [GraphiQL Playground](https://www.apollographql.com/docs/apollo-server/testing/graphql-playground/)
1. [TypeScript](https://www.typescriptlang.org/)
1. [Node.js](https://nodejs.org/en/)
1. [GraphQL Code Generator](https://graphql-code-generator.com/)

## Quick Start

To use this tool in deployment, go to the [GraphQLPlaground](https://us-central1-factory-town-prod-line-planner.cloudfunctions.net/apolloServer/api) hosted on Firebase Functions. The project has been scaffolded for the most part, the actual planner business logic was developed with [LINQPad](https://www.linqpad.net/) and it has yet to be ported to this project.

## Design Considerations

### Why GraphQL

Primary reason for using GraphQL is to exploit its ability to expose schema to the client. Included in the schema is two enum types that include all available names in game, for products and facilities. User input for product and facility would be restricted to these two enum types, that makes it possible to avoid string input parsing and frustration caused by unavoidable typos if it was a REST Api.

It also provides an interface, GraphQLPlayground, that people could interact with. It is not extremely intuitive to use for the general public but it's better than nothing (Imagine using postman). I do not intend to create a UI for this project in the near future as css scares me :)

### Why Firebase

Firebase provides easy-to-use integrated function triggers and databases, as well as a very generous free tier for usage.

### GraphQL Code Generator

The GraphQL code generator is a great tool to avoid the pain of having to write the types in schema and code twice and trying to make them match.

## Project Structure

### `./functions`

The `functions` folder holds the code that gets deployed to Firebase Functions:

-   `./src/apollo`: Holds GraphQL schema, resolvers, and directive implementations. Has apollo server in the root directory [`server.ts`](./functions/src/apollo/server.ts). Types generated by code-gen tool is in [`generated/types.ts`](./functions/src/apollo/generated/types.ts)

-   `./src/dataSources`: Holds classes and interfaces that concern about getting and setting data. For now it has a very basic implementation to use Firebase Firestore as backend database that does not yet support batch read and write or other fancy features.

-   `./src/utilities`: Holds some utility code as the folder name may suggest.

-   `./src/index.ts`: Exposes api endpoints to Firebase Functions. Could support deploying to a standalone express server without Firebase Functions as well.
